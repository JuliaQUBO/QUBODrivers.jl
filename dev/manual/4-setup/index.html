<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Sampler Setup · QUBODrivers.jl</title><meta name="title" content="Sampler Setup · QUBODrivers.jl"/><meta property="og:title" content="Sampler Setup · QUBODrivers.jl"/><meta property="twitter:title" content="Sampler Setup · QUBODrivers.jl"/><meta name="description" content="Documentation for QUBODrivers.jl."/><meta property="og:description" content="Documentation for QUBODrivers.jl."/><meta property="twitter:description" content="Documentation for QUBODrivers.jl."/><script data-outdated-warner src="../../assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="../.."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="../../assets/documenter.js"></script><script src="../../search_index.js"></script><script src="../../siteinfo.js"></script><script src="../../../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="../../assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="../../assets/themeswap.js"></script><link href="../../assets/extra_styles.css" rel="stylesheet" type="text/css"/></head><body><div id="documenter"><nav class="docs-sidebar"><a class="docs-logo" href="../../"><img src="../../assets/logo.svg" alt="QUBODrivers.jl logo"/></a><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="../../">Home</a></li><li><span class="tocitem">Manual</span><ul><li><a class="tocitem" href="../1-intro/">Introduction</a></li><li><a class="tocitem" href="../2-solve/">Solving QUBO</a></li><li><a class="tocitem" href="../3-samplers/">Samplers</a></li><li class="is-active"><a class="tocitem" href>Sampler Setup</a><ul class="internal"><li><a class="tocitem" href="#Imports"><span>Imports</span></a></li><li><a class="tocitem" href="#The-[QUBODrivers.@setup](@ref)-macro"><span>The <code>QUBODrivers.@setup</code> macro</span></a></li><li><a class="tocitem" href="#The-[QUBODrivers.sample](@ref)-method"><span>The <code>QUBODrivers.sample</code> method</span></a></li><li><a class="tocitem" href="#A-complete-example"><span>A complete example</span></a></li></ul></li><li><a class="tocitem" href="../5-tests/">Test Suite</a></li><li><a class="tocitem" href="../6-benchmarks/">Benchmarking</a></li></ul></li><li><span class="tocitem">Booklet</span><ul><li><a class="tocitem" href="../../booklet/1-intro/">Itroduction</a></li><li><a class="tocitem" href="../../booklet/2-interface/">Sampler Interface</a></li><li><a class="tocitem" href="../../booklet/3-attributes/">Attribute System</a></li></ul></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li><a class="is-disabled">Manual</a></li><li class="is-active"><a href>Sampler Setup</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href>Sampler Setup</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/JuliaQUBO/QUBODrivers.jl" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/JuliaQUBO/QUBODrivers.jl/blob/master/docs/src/manual/4-setup.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="Sampler-Setup"><a class="docs-heading-anchor" href="#Sampler-Setup">Sampler Setup</a><a id="Sampler-Setup-1"></a><a class="docs-heading-anchor-permalink" href="#Sampler-Setup" title="Permalink"></a></h1><p>This guide aims to provide a tutorial on how to implement new sampler interfaces using <a href="https://github.com/psrenergy/QUBODrivers.jl">QUBODrivers.jl</a>. To get your QUBO sampler running right now, <a href="https://github.com/psrenergy/QUBODrivers.jl">QUBODrivers.jl</a> will require only two main ingredients: a <a href="#QUBODrivers.@setup"><code>QUBODrivers.@setup</code></a> macro call and a <a href="#QUBODrivers.sample"><code>QUBODrivers.sample</code></a> method implementation.</p><h2 id="Imports"><a class="docs-heading-anchor" href="#Imports">Imports</a><a id="Imports-1"></a><a class="docs-heading-anchor-permalink" href="#Imports" title="Permalink"></a></h2><p>First things first, we are going to import both <a href="https://github.com/psrenergy/QUBODrivers.jl">QUBODrivers.jl</a> and also <a href="https://github.com/jump-dev/MathOptInterface.jl">MathOptInterface.jl</a>, commonly aliased as <code>MOI</code>. Although not strictly necessary, we recommend that you also import <a href="https://github.com/psrenergy/QUBOTools.jl">QUBOTools.jl</a>for convenience, as it provides many useful functions for QUBO manipulation. It is readly available in the <code>QUBODrivers</code> module.</p><pre><code class="language-julia hljs">import QUBODrivers
import QUBODrivers: QUBOTools
import MathOptInterface as MOI</code></pre><h2 id="The-[QUBODrivers.@setup](@ref)-macro"><a class="docs-heading-anchor" href="#The-[QUBODrivers.@setup](@ref)-macro">The <a href="#QUBODrivers.@setup"><code>QUBODrivers.@setup</code></a> macro</a><a id="The-[QUBODrivers.@setup](@ref)-macro-1"></a><a class="docs-heading-anchor-permalink" href="#The-[QUBODrivers.@setup](@ref)-macro" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QUBODrivers.@setup" href="#QUBODrivers.@setup"><code>QUBODrivers.@setup</code></a> — <span class="docstring-category">Macro</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">@setup(expr)</code></pre><p>The <code>@setup</code> macro receives a <code>begin ... end</code> block with an attribute definition on each of the block&#39;s statements.</p><p><strong>Sampler Attributes</strong></p><p>All attributes must be presented as an assignment to the default value of that attribute. To create a MathOptInterface optimizer attribute, an identifier must be present on the left hand side. If a solver-specific, raw attribute is desired, its name must be given as a string, e.g. between double quotes. In the special case where an attribute could be accessed in both ways, the identifier must be followed by the parenthesised raw attribute string. In any case, the attribute type can be specified typing the type assertion operator <code>::</code> followed by the type itself just before the equal sign.</p><p>For example, a list of the valid syntax variations for the <em>number of reads</em> attribute follows:     - <code>&quot;num_reads&quot; = 1_000</code>     - <code>&quot;num_reads&quot;::Integer = 1_000</code>     - <code>NumberOfReads = 1_000</code>     - <code>NumberOfReads::Integer = 1_000</code>     - <code>NumberOfReads(&quot;num_reads&quot;) = 1_000</code>     - <code>NumberOfReads(&quot;num_reads&quot;)::Integer = 1_000</code></p><p><strong>Example</strong></p><pre><code class="nohighlight hljs">QUBODrivers.@setup Optimizer begin
    name       = &quot;Super Sampler&quot;
    version    = v&quot;1.0.2&quot;
    attributes = begin
        NumberOfReads[&quot;num_reads&quot;]::Integer  = 1_000
        SuperAttribute[&quot;super_attr&quot;]         = nothing
        MegaAttribute::Union{String,Nothing} = &quot;mega&quot;
    end
end</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaQUBO/QUBODrivers.jl/blob/af4b60ba77fa9fdbf6a66257f80ff213326391cc/src/library/setup/macro.jl#L1-L35">source</a></section></article><p>This macro takes two arguments: the identifier of the sampler&#39;s <code>struct</code> (usually <code>Optimizer</code>), and a <code>begin...end</code> block containing configuration parameters as <em>key-value</em> pairs.</p><p>The first parameter of the configuration block is the sampler&#39;s name, which will be used to identify it in the <code>MOI.SolverName</code> attribute.</p><p>The next entry is the <code>version</code> assignment, which is accessed by the <code>MOI.SolverVersion</code> attribute. In order to consistently support <a href="https://semver.org/">semantic versioning</a> it is required that the version number comes as a <em>v-string</em> e.g. <code>v&quot;major.minor.patch&quot;</code>.</p><div class="admonition is-info"><header class="admonition-header">Note</header><div class="admonition-body"><p>If missing, the <code>version</code> parameter matches the current version of <code>QUBODrivers.jl</code>.</p></div></div><p>A simple yet valid <code>@setup</code> call would look like this:</p><pre><code class="language-julia hljs">QUBODrivers.@setup Optimizer begin
    name    = &quot;Super Sampler&quot;
    version = v&quot;1.0.2&quot;
end</code></pre><p>We expect that most users will be happy with this approach and it is likely that it will fit most use cases.</p><h3 id="Attributes"><a class="docs-heading-anchor" href="#Attributes">Attributes</a><a id="Attributes-1"></a><a class="docs-heading-anchor-permalink" href="#Attributes" title="Permalink"></a></h3><p>The <code>attributes</code> parameter is also given by a <code>begin...end</code> block and contains the sampler&#39;s attributes. These attributes are used to configure the sampler&#39;s behavior and are accessed by the <code>MOI.get</code> method.</p><pre><code class="language-julia hljs">QUBODrivers.@setup Optimizer begin
    name    = &quot;Super Sampler&quot;
    version = v&quot;1.0.2&quot;
    attributes = begin
        NumberOfReads[&quot;num_reads&quot;]::Integer = 1_000
        SuperAttribute::String = &quot;super&quot;
    end
end</code></pre><h2 id="The-[QUBODrivers.sample](@ref)-method"><a class="docs-heading-anchor" href="#The-[QUBODrivers.sample](@ref)-method">The <a href="#QUBODrivers.sample"><code>QUBODrivers.sample</code></a> method</a><a id="The-[QUBODrivers.sample](@ref)-method-1"></a><a class="docs-heading-anchor-permalink" href="#The-[QUBODrivers.sample](@ref)-method" title="Permalink"></a></h2><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="QUBODrivers.sample" href="#QUBODrivers.sample"><code>QUBODrivers.sample</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">sample(::AbstractSampler{T})::SampleSet{T} where {T}</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/JuliaQUBO/QUBODrivers.jl/blob/af4b60ba77fa9fdbf6a66257f80ff213326391cc/src/interface/sampler.jl#L6-L8">source</a></section></article><h3 id="The-[QUBODrivers.SampleSet]-collection"><a class="docs-heading-anchor" href="#The-[QUBODrivers.SampleSet]-collection">The [<code>QUBODrivers.SampleSet</code>] collection</a><a id="The-[QUBODrivers.SampleSet]-collection-1"></a><a class="docs-heading-anchor-permalink" href="#The-[QUBODrivers.SampleSet]-collection" title="Permalink"></a></h3><h2 id="A-complete-example"><a class="docs-heading-anchor" href="#A-complete-example">A complete example</a><a id="A-complete-example-1"></a><a class="docs-heading-anchor-permalink" href="#A-complete-example" title="Permalink"></a></h2><pre><code class="language-julia hljs">module SuperSampler

import QUBODrivers
import QUBODrivers: QUBOTools
import MathOptInterface as MOI

@doc raw&quot;&quot;&quot;
    SuperSampler.Optimizer

This sampler is super!
&quot;&quot;&quot;
QUBODrivers.@setup Optimizer begin
    name    = &quot;Super Sampler&quot;
    version = v&quot;1.0.2&quot;
    attributes = begin
        NumberOfReads[&quot;num_reads&quot;]::Integer = 1_000
        SuperAttribute::String = &quot;super&quot;
    end
end

function QUBODrivers.sample(sampler::Optimizer{T}) where {T}
    # ~ Is your annealer running on the Ising Model? Have this:
    n, h, J, α, β = QUBOTools.ising(
        sampler,
        :dense; # Here we opt for a dense matrix representation
        sense = :max,
    )

    # ~ Retrieve Attributes using MathOptInterface ~ #
    num_reads  = MOI.get(sampler, NumberOfReads())
    super_attr = MOI.get(sampler, SuperAttribute())

    # ~ Do some sampling ~ #
    samples = QUBOTools.Sample{T,Int}[]

    clock = @timed for _ = 1:num_reads
        ψ = super_sample(n, h, J, super_attr)
        λ = QUBOTools.value(ψ, h, J, α, β)

        s = QUBOTools.Sample{T,Int}(ψ, λ)

        push!(samples, s)
    end

    # ~ Store some metadata ~ #
    metadata = Dict{String,Any}(
        &quot;num_reads&quot;  =&gt; num_reads,
        &quot;super_attr&quot; =&gt; super_attr,
        &quot;time&quot;       =&gt; clock.time,
    )

    # ~ Return a SampleSet ~ #
    return QUBOTools.SampleSet(samples, metadata; sense=:max, domain=:spin)
end

function super_sample(n, h, J, super_attr)
    # ~ Do some super sampling (using C/C++) ~ #
    ψ = ccall(
        :super_sample,
        Vector{Int},
        (
            Cint,
            Ptr{Float64},
            Ptr{Ptr{Float64}},
            Cstring
        ),
        n,
        h,
        J,
        super_attr,
    )

    return ψ
end

end # module</code></pre></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="../3-samplers/">« Samplers</a><a class="docs-footer-nextpage" href="../5-tests/">Test Suite »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.7.0 on <span class="colophon-date" title="Wednesday 2 October 2024 06:30">Wednesday 2 October 2024</span>. Using Julia version 1.9.4.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
